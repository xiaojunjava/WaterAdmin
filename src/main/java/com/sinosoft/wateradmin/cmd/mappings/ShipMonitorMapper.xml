<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<!--车船实时位置监控记录表映射文件-->
<mapper namespace="com.sinosoft.wateradmin.cmd.dao.IShipMonitorDAO">
    <resultMap id="BaseResultMap" type="com.sinosoft.wateradmin.cmd.bean.ShipMonitor">
        <id column="CSM_ID" property="csmId" jdbcType="INTEGER"/>
        <result column="SA_ID" property="saId" jdbcType="INTEGER"/>
        <result column="SM_BEGINTIME" property="smBeginTime" jdbcType="TIMESTAMP"/>
        <result column="SM_ENDTIME" property="smEndTime" jdbcType="TIMESTAMP"/>
        <result column="SM_TRAJECTORY" property="smTraJectory" jdbcType="CLOB"/>
        <result column="REMARK" property="remark" jdbcType="VARCHAR"/>
    </resultMap>
    <resultMap id="ShipMonitorSaMap" type="com.sinosoft.wateradmin.cmd.bean.ShipMonitor" extends="BaseResultMap">
        <association property="shipArchives" javaType="com.sinosoft.wateradmin.cmd.bean.ShipArchives">
            <result column="SA_ID" property="saId" jdbcType="INTEGER"/>
            <result column="SA_NAME" property="saName" jdbcType="VARCHAR"/>
            <result column="SA_TYPE" property="saType" jdbcType="VARCHAR"/>
        </association>
    </resultMap>
    <sql id="Base_Column_List">
        CSM_ID, SA_ID, SM_BEGINTIME, SM_ENDTIME, SM_TRAJECTORY,REMARK
    </sql>
    <sql id="Base_Table">
        CMD_SHIP_MONITOR
    </sql>
    <sql id="select_rel">
        select a.*,b.SA_ID,b.SA_NAME,b.SA_TYPE from CMD_SHIP_MONITOR a left join CMD_SHIP_ARCHIVES b on a.SA_ID=b.SA_ID
    </sql>
    <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="INTEGER">
        select  <include refid="Base_Column_List"/>   from <include refid="Base_Table"/>
        where CSM_ID = #{csmId,jdbcType=INTEGER}
    </select>
    <select id="selectDatas" resultMap="BaseResultMap" parameterType="com.sinosoft.wateradmin.cmd.bean.ShipMonitor">
        select <include refid="Base_Column_List"/>  from <include refid="Base_Table"/> where 1=1
        <if test="csmId != null and  csmId !=''">
            and CSM_ID=#{csmId,jdbcType=INTEGER}
        </if>
        <if test="saId != null and  saId !=''">
            and SA_ID =#{saId,jdbcType=INTEGER}
        </if>
        <if test="startTime != null and  startTime !=''" >
            and SM_BEGINTIME <![CDATA[ >= ]]> TO_DATE(#{startTime},'yyyy-MM-dd HH24:mi:ss')
        </if>
        <if test="endTime != null and  endTime !=''" >
            and SM_BEGINTIME <![CDATA[ <= ]]> TO_DATE(#{endTime},'yyyy-MM-dd HH24:mi:ss')
        </if>
        <if test="remark != null and  remark !=''">
            and REMARK like  CONCAT(CONCAT('%', #{remark,jdbcType=VARCHAR}), '%')
        </if>
    </select>
    <select id="selectPlanDatas" resultMap="BaseResultMap" parameterType="String">
        <include refid="select_rel"/>   where 1=1
        <if test="planSql != null and  planSql !=''">
            ${planSql}
        </if>
    </select>
    <delete id="deleteByPrimaryKey" parameterType="int">
        delete from <include refid="Base_Table"/>
        where CSM_ID = #{csmId,jdbcType=INTEGER}
    </delete>
    <insert id="insert" parameterType="com.sinosoft.wateradmin.cmd.bean.ShipMonitor">
        <selectKey resultType="INTEGER" keyProperty="csmId" order="BEFORE">
            　　　select seq_shipmonitor_csmid.nextval from dual
        </selectKey>
        insert into <include refid="Base_Table"/> (  <include refid="Base_Column_List"/>  )
        values (#{csmId,jdbcType=INTEGER}, #{saId,jdbcType=INTEGER}, #{smBeginTime,jdbcType=TIMESTAMP},
        #{smEndTime,jdbcType=TIMESTAMP}, #{smTraJectory,jdbcType=CLOB}, #{remark,jdbcType=VARCHAR})
    </insert>

    <update id="update" parameterType="com.sinosoft.wateradmin.cmd.bean.ShipMonitor">
        update <include refid="Base_Table"/>
        <set>
            <if test="saId != null and  saId !=''">
                SA_ID = #{saId,jdbcType=INTEGER},
            </if>
            <if test="smBeginTime != null and  smBeginTime !=''">
                SM_BEGINTIME = #{smBeginTime,jdbcType=TIMESTAMP},
            </if>
            <if test="smEndTime != null and  smEndTime !=''">
                SM_ENDTIME = #{smEndTime,jdbcType=TIMESTAMP},
            </if>
            <if test="smTraJectory != null and  smTraJectory !=''">
                SM_TRAJECTORY = #{smTraJectory,jdbcType=CLOB},
            </if>
            <if test="remark != null and  remark !=''">
                REMARK = #{remark,jdbcType=VARCHAR},
            </if>
        </set>
        where CSM_ID = #{csmId,jdbcType=INTEGER}
    </update>

</mapper>